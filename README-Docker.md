# jshERP Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—

æœ¬æ–‡æ¡£æä¾›äº† jshERP ç³»ç»Ÿçš„å®Œæ•´ Docker å®¹å™¨åŒ–è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„å¿«é€Ÿæ­å»ºã€‚

## ğŸ“‹ ç›®å½•

- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [å¼€å‘ç¯å¢ƒ](#å¼€å‘ç¯å¢ƒ)
- [ç”Ÿäº§ç¯å¢ƒ](#ç”Ÿäº§ç¯å¢ƒ)
- [æœåŠ¡ç®¡ç†](#æœåŠ¡ç®¡ç†)
- [ç«¯å£é…ç½®](#ç«¯å£é…ç½®)
- [æ•°æ®æŒä¹…åŒ–](#æ•°æ®æŒä¹…åŒ–)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

jshERP Docker å®¹å™¨åŒ–æ¶æ„åŒ…å«ä»¥ä¸‹æœåŠ¡ç»„ä»¶ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Nginx (1.12.2)             â”‚  â† åå‘ä»£ç†/è´Ÿè½½å‡è¡¡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend       â”‚  â”‚   Backend       â”‚
â”‚  Vue 2.7.16     â”‚  â”‚ SpringBoot 2.0  â”‚
â”‚  Node 20.17.0   â”‚  â”‚   JDK 1.8       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼                                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     MySQL       â”‚            â”‚     Redis       â”‚
    â”‚     5.7.33      â”‚            â”‚     6.2.1       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’» ç¯å¢ƒè¦æ±‚

### å¿…éœ€è½¯ä»¶
- **Docker**: 20.10.0+
- **Docker Compose**: 1.29.0+
- **æ“ä½œç³»ç»Ÿ**: Linux/macOS/Windows
- **å†…å­˜**: æœ€å°‘ 4GB RAM (æ¨è 8GB+)
- **ç£ç›˜ç©ºé—´**: æœ€å°‘ 10GB å¯ç”¨ç©ºé—´

### æ¨èé…ç½®
- **CPU**: 4 æ ¸å¿ƒä»¥ä¸Š
- **å†…å­˜**: 8GB RAM ä»¥ä¸Š
- **ç£ç›˜**: SSD ç¡¬ç›˜ï¼Œ20GB+ å¯ç”¨ç©ºé—´## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/WaterJason/jshERP
cd jshERP-0612-Cursor
```

### 2. ç¯å¢ƒé…ç½®
```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼ˆå·²æä¾›é»˜è®¤é…ç½®ï¼‰
cp .env .env.local  # å¯é€‰ï¼šåˆ›å»ºæœ¬åœ°é…ç½®å‰¯æœ¬

# æ ¹æ®éœ€è¦ä¿®æ”¹ç«¯å£é…ç½®
vim .env
```

### 3. å¯åŠ¨å¼€å‘ç¯å¢ƒ
```bash
# ä½¿ç”¨è„šæœ¬å¯åŠ¨ï¼ˆæ¨èï¼‰
./docker/scripts/start-dev.sh

# æˆ–æ‰‹åŠ¨å¯åŠ¨
docker-compose -f docker-compose.dev.yml up -d
```

### 4. è®¿é—®ç³»ç»Ÿ
- **å‰ç«¯åº”ç”¨**: http://localhost:3000
- **åç«¯API**: http://localhost:9999/jshERP-boot
- **Nginxä»£ç†**: http://localhost:8000
- **é»˜è®¤è´¦å·**: admin / 123456

## âš™ï¸ ç¯å¢ƒé…ç½®

### ç«¯å£é…ç½®
åœ¨ `.env` æ–‡ä»¶ä¸­å¯ä»¥è‡ªå®šä¹‰å„æœåŠ¡çš„ç«¯å£æ˜ å°„ï¼š

```bash
# å‰ç«¯æœåŠ¡ç«¯å£
HOST_FRONTEND_PORT=3000

# åç«¯æœåŠ¡ç«¯å£  
HOST_BACKEND_PORT=9999

# MySQL æ•°æ®åº“ç«¯å£
HOST_MYSQL_PORT=3306

# Redis ç¼“å­˜ç«¯å£
HOST_REDIS_PORT=6379

# Nginx ä»£ç†ç«¯å£
HOST_NGINX_PORT=8000
```

### æ•°æ®åº“é…ç½®
```bash
# MySQL é…ç½®
MYSQL_ROOT_PASSWORD=123456
MYSQL_DATABASE=jsh_erp
MYSQL_USER=jsh_user
MYSQL_PASSWORD=123456

# Redis é…ç½®  
REDIS_PASSWORD=1234abcd
```## ğŸ”§ å¼€å‘ç¯å¢ƒ

å¼€å‘ç¯å¢ƒæ”¯æŒçƒ­é‡è½½ï¼Œä»£ç ä¿®æ”¹åè‡ªåŠ¨é‡æ–°ç¼–è¯‘å’Œéƒ¨ç½²ã€‚

### å¯åŠ¨å¼€å‘ç¯å¢ƒ
```bash
# ä½¿ç”¨å¯åŠ¨è„šæœ¬
./docker/scripts/start-dev.sh

# æ‰‹åŠ¨å¯åŠ¨
docker-compose -f docker-compose.dev.yml up -d
```

### å¼€å‘ç¯å¢ƒç‰¹æ€§
- âœ… **å‰ç«¯çƒ­é‡è½½**: Vue å¼€å‘æœåŠ¡å™¨è‡ªåŠ¨é‡æ–°ç¼–è¯‘
- âœ… **åç«¯çƒ­é‡è½½**: SpringBoot DevTools æ”¯æŒ
- âœ… **æºç æŒ‚è½½**: æœ¬åœ°ä»£ç å˜æ›´å®æ—¶åŒæ­¥åˆ°å®¹å™¨
- âœ… **è°ƒè¯•æ¨¡å¼**: æ”¯æŒè¿œç¨‹è°ƒè¯•
- âœ… **å®æ—¶æ—¥å¿—**: å®æ—¶æŸ¥çœ‹åº”ç”¨æ—¥å¿—

### æºç æŒ‚è½½ç›®å½•
```
./jshERP-boot â†’ /app            # åç«¯æºç 
./jshERP-web â†’ /app             # å‰ç«¯æºç 
~/.m2 â†’ /root/.m2               # Maven æœ¬åœ°ä»“åº“
```

## ğŸ­ ç”Ÿäº§ç¯å¢ƒ

ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–äº†æ€§èƒ½å’Œå®‰å…¨æ€§é…ç½®ã€‚

### å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
```bash
# ä½¿ç”¨å¯åŠ¨è„šæœ¬
./docker/scripts/start-prod.sh

# æ‰‹åŠ¨å¯åŠ¨
docker-compose -f docker-compose.prod.yml up -d
```

### ç”Ÿäº§ç¯å¢ƒç‰¹æ€§
- âœ… **å¤šé˜¶æ®µæ„å»º**: æœ€å°åŒ–é•œåƒä½“ç§¯
- âœ… **èµ„æºé™åˆ¶**: é™åˆ¶CPUå’Œå†…å­˜ä½¿ç”¨
- âœ… **å¥åº·æ£€æŸ¥**: è‡ªåŠ¨å¥åº·çŠ¶æ€ç›‘æ§
- âœ… **æ—¥å¿—è½®è½¬**: é˜²æ­¢æ—¥å¿—æ–‡ä»¶è¿‡å¤§
- âœ… **å®‰å…¨åŠ å›º**: érootç”¨æˆ·è¿è¡Œ

## ğŸ“Š æœåŠ¡ç®¡ç†

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
# å¼€å‘ç¯å¢ƒ
docker-compose -f docker-compose.dev.yml ps

# ç”Ÿäº§ç¯å¢ƒ  
docker-compose -f docker-compose.prod.yml ps
```

### æŸ¥çœ‹æœåŠ¡æ—¥å¿—
```bash
# ä½¿ç”¨æ—¥å¿—è„šæœ¬
./docker/scripts/logs.sh dev [æœåŠ¡å]

# æ‰‹åŠ¨æŸ¥çœ‹
docker-compose -f docker-compose.dev.yml logs -f [æœåŠ¡å]
```

### åœæ­¢æœåŠ¡
```bash
# ä½¿ç”¨åœæ­¢è„šæœ¬
./docker/scripts/stop.sh [dev|prod|all]

# æ‰‹åŠ¨åœæ­¢
docker-compose -f docker-compose.dev.yml down
```## ğŸ”Œ ç«¯å£é…ç½®

### é»˜è®¤ç«¯å£æ˜ å°„
| æœåŠ¡ | å®¹å™¨ç«¯å£ | å®¿ä¸»æœºç«¯å£ | è¯´æ˜ |
|------|---------|-----------|------|
| å‰ç«¯ | 8080 | 3000 | Vue å¼€å‘æœåŠ¡å™¨ |
| åç«¯ | 9999 | 9999 | SpringBoot API |
| MySQL | 3306 | 3306 | æ•°æ®åº“æœåŠ¡ |
| Redis | 6379 | 6379 | ç¼“å­˜æœåŠ¡ |
| Nginx | 80 | 8000 | åå‘ä»£ç† |

### ç«¯å£å†²çªè§£å†³
å¦‚æœé»˜è®¤ç«¯å£è¢«å ç”¨ï¼Œå¯ä»¥ä¿®æ”¹ `.env` æ–‡ä»¶ï¼š

```bash
# ä¾‹å¦‚ï¼šä¿®æ”¹å‰ç«¯ç«¯å£ä¸º 3001
HOST_FRONTEND_PORT=3001

# ä¿®æ”¹ Nginx ç«¯å£ä¸º 8080  
HOST_NGINX_PORT=8080
```

## ğŸ’¾ æ•°æ®æŒä¹…åŒ–

### æ•°æ®å·æŒ‚è½½
```
./volumes/mysql     â†’ MySQL æ•°æ®ç›®å½•
./volumes/redis     â†’ Redis æ•°æ®ç›®å½•  
./volumes/uploads   â†’ æ–‡ä»¶ä¸Šä¼ ç›®å½•
./volumes/logs      â†’ åº”ç”¨æ—¥å¿—ç›®å½•
```

### æ•°æ®å¤‡ä»½
```bash
# MySQL æ•°æ®å¤‡ä»½
docker exec jsherp-mysql-dev mysqldump -uroot -p123456 jsh_erp > backup_$(date +%Y%m%d).sql

# Redis æ•°æ®å¤‡ä»½
docker exec jsherp-redis-dev redis-cli --rdb /data/dump_$(date +%Y%m%d).rdb
```

## â“ å¸¸è§é—®é¢˜

### Q1: ç«¯å£è¢«å ç”¨å¦‚ä½•è§£å†³ï¼Ÿ
**A**: ä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„ç«¯å£é…ç½®ï¼Œç„¶åé‡æ–°å¯åŠ¨æœåŠ¡ã€‚

### Q2: å¦‚ä½•é‡ç½®æ•°æ®åº“ï¼Ÿ
**A**: 
```bash
# åœæ­¢æœåŠ¡
./docker/scripts/stop.sh

# åˆ é™¤æ•°æ®å·
rm -rf ./volumes/mysql

# é‡æ–°å¯åŠ¨æœåŠ¡
./docker/scripts/start-dev.sh
```

### Q3: å‰ç«¯ä¿®æ”¹ä»£ç åä¸ç”Ÿæ•ˆï¼Ÿ
**A**: ç¡®ä¿ä½¿ç”¨å¼€å‘ç¯å¢ƒå¯åŠ¨ï¼Œæ£€æŸ¥æ–‡ä»¶æŒ‚è½½æ˜¯å¦æ­£ç¡®ï¼š
```bash
docker-compose -f docker-compose.dev.yml exec jsherp-frontend-dev ls -la /app
```

### Q4: åç«¯å¯åŠ¨å¤±è´¥ï¼Ÿ
**A**: æ£€æŸ¥æ•°æ®åº“è¿æ¥å’Œä¾èµ–æ˜¯å¦å°±ç»ªï¼š
```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
./docker/scripts/logs.sh dev jsherp-backend-dev

# æ£€æŸ¥æ•°æ®åº“è¿æ¥
docker-compose -f docker-compose.dev.yml exec jsherp-mysql mysql -uroot -p123456 -e "SHOW DATABASES;"
```## ğŸ” æ•…éšœæ’æŸ¥

### æ£€æŸ¥å®¹å™¨çŠ¶æ€
```bash
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çŠ¶æ€
docker ps -a

# æŸ¥çœ‹ç‰¹å®šå®¹å™¨æ—¥å¿—
docker logs -f <å®¹å™¨å>

# è¿›å…¥å®¹å™¨å†…éƒ¨è°ƒè¯•
docker exec -it <å®¹å™¨å> /bin/bash
```

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

#### 1. æ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥ MySQL å®¹å™¨çŠ¶æ€
docker-compose -f docker-compose.dev.yml ps jsherp-mysql

# æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
docker-compose -f docker-compose.dev.yml exec jsherp-backend-dev ping jsherp-mysql
```

#### 2. Redis è¿æ¥å¤±è´¥
```bash
# æµ‹è¯• Redis è¿æ¥
docker-compose -f docker-compose.dev.yml exec jsherp-redis redis-cli ping
```

#### 3. æ–‡ä»¶ä¸Šä¼ å¤±è´¥
```bash
# æ£€æŸ¥ä¸Šä¼ ç›®å½•æƒé™
docker-compose -f docker-compose.dev.yml exec jsherp-backend-dev ls -la /opt/jshERP/upload
```

#### 4. å‰ç«¯èµ„æºåŠ è½½å¤±è´¥
```bash
# æ£€æŸ¥ Nginx é…ç½®
docker-compose -f docker-compose.dev.yml exec jsherp-nginx-dev nginx -t

# é‡æ–°åŠ è½½ Nginx é…ç½®
docker-compose -f docker-compose.dev.yml exec jsherp-nginx-dev nginx -s reload
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### å¼€å‘ç¯å¢ƒ
- å¯ç”¨æ–‡ä»¶ç›‘å¬è½®è¯¢ï¼š`CHOKIDAR_USEPOLLING=true`
- ä½¿ç”¨ cached æŒ‚è½½æ¨¡å¼å‡å°‘ I/O å¼€é”€
- é€‚å½“è°ƒæ•´å®¹å™¨å†…å­˜é™åˆ¶

#### ç”Ÿäº§ç¯å¢ƒ
- ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–é•œåƒå¤§å°
- å¯ç”¨åº”ç”¨å±‚ç¼“å­˜
- é…ç½®é€‚å½“çš„ JVM å‚æ•°
- ä½¿ç”¨ SSD å­˜å‚¨æå‡æ•°æ®åº“æ€§èƒ½

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–å¸®åŠ©ï¼š

1. **æŸ¥çœ‹æ—¥å¿—**: ä½¿ç”¨ `./docker/scripts/logs.sh` æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
2. **æ£€æŸ¥é…ç½®**: ç¡®ä¿ `.env` æ–‡ä»¶é…ç½®æ­£ç¡®
3. **é‡å¯æœåŠ¡**: å°è¯•é‡å¯ç›¸å…³æœåŠ¡è§£å†³ä¸´æ—¶é—®é¢˜
4. **æ¸…ç†ç¯å¢ƒ**: ä½¿ç”¨ `docker system prune` æ¸…ç†æ— ç”¨èµ„æº

## ğŸ“ æ›´æ–°å†å²

- **v1.0.0**: åˆå§‹ Docker å®¹å™¨åŒ–æ–¹æ¡ˆ
  - æ”¯æŒå¼€å‘å’Œç”Ÿäº§ç¯å¢ƒåˆ†ç¦»
  - å®Œæ•´çš„æœåŠ¡ç¼–æ’å’Œé…ç½®
  - æ•°æ®æŒä¹…åŒ–å’Œå¥åº·æ£€æŸ¥
  - è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£å’Œæ•…éšœæ’æŸ¥æŒ‡å—

---

**ğŸ‰ æ­å–œï¼æ‚¨å·²æˆåŠŸå®Œæˆ jshERP ç³»ç»Ÿçš„ Docker å®¹å™¨åŒ–éƒ¨ç½²ã€‚å¼€å§‹æ‚¨çš„å¼€å‘ä¹‹æ—…å§ï¼**