# jshERP ç³»ç»Ÿ Docker åŒ–éƒ¨ç½²ä¸é—®é¢˜è§£å†³å®Œæ•´æŒ‡å—

## ç›®å½•
- [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
- [å®Œæ•´éƒ¨ç½²æŒ‡å—](#å®Œæ•´éƒ¨ç½²æŒ‡å—)
- [é—®é¢˜è¯Šæ–­ä¸è§£å†³æ–¹æ¡ˆ](#é—®é¢˜è¯Šæ–­ä¸è§£å†³æ–¹æ¡ˆ)
- [ç³»ç»Ÿè®¿é—®ä¿¡æ¯](#ç³»ç»Ÿè®¿é—®ä¿¡æ¯)
- [åŠŸèƒ½éªŒè¯æ¸…å•](#åŠŸèƒ½éªŒè¯æ¸…å•)
- [ç»´æŠ¤ä¸è¿ç»´æŒ‡å—](#ç»´æŠ¤ä¸è¿ç»´æŒ‡å—)
- [å¸¸è§é—®é¢˜ FAQ](#å¸¸è§é—®é¢˜-faq)

## ç³»ç»Ÿæ¦‚è¿°

### jshERP ç®€ä»‹
jshERPï¼ˆç®¡ä¼Šä½³ERPï¼‰æ˜¯ä¸€æ¬¾å¼€æºçš„ä¼ä¸šèµ„æºè§„åˆ’ç³»ç»Ÿï¼Œä¸“ä¸ºä¸­å°ä¼ä¸šè®¾è®¡ï¼Œæä¾›å®Œæ•´çš„è¿›é”€å­˜ç®¡ç†ã€è´¢åŠ¡ç®¡ç†ã€æŠ¥è¡¨åˆ†æç­‰åŠŸèƒ½ã€‚

### ä¸»è¦åŠŸèƒ½æ¨¡å—
- **é›¶å”®ç®¡ç†**ï¼šé›¶å”®å‡ºåº“ã€é›¶å”®é€€è´§
- **é‡‡è´­ç®¡ç†**ï¼šè¯·è´­å•ã€é‡‡è´­è®¢å•ã€é‡‡è´­å…¥åº“ã€é‡‡è´­é€€è´§
- **é”€å”®ç®¡ç†**ï¼šé”€å”®è®¢å•ã€é”€å”®å‡ºåº“ã€é”€å”®é€€è´§
- **ä»“åº“ç®¡ç†**ï¼šå…¶å®ƒå…¥åº“ã€å…¶å®ƒå‡ºåº“ã€è°ƒæ‹¨å‡ºåº“ã€ç»„è£…å•ã€æ‹†å¸å•
- **è´¢åŠ¡ç®¡ç†**ï¼šæ”¶å…¥å•ã€æ”¯å‡ºå•ã€æ”¶æ¬¾å•ã€ä»˜æ¬¾å•ã€è½¬è´¦å•ã€æ”¶é¢„ä»˜æ¬¾
- **æŠ¥è¡¨æŸ¥è¯¢**ï¼šå•†å“åº“å­˜ã€è´¦æˆ·ç»Ÿè®¡ã€é‡‡è´­ç»Ÿè®¡ã€é”€å”®ç»Ÿè®¡ç­‰
- **å•†å“ç®¡ç†**ï¼šå•†å“ç±»åˆ«ã€å•†å“ä¿¡æ¯ã€å¤šå•ä½ã€å¤šå±æ€§
- **åŸºç¡€èµ„æ–™**ï¼šä¾›åº”å•†ã€å®¢æˆ·ã€ä¼šå‘˜ã€ä»“åº“ã€æ”¶æ”¯é¡¹ç›®ã€ç»“ç®—è´¦æˆ·
- **ç³»ç»Ÿç®¡ç†**ï¼šè§’è‰²ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€æœºæ„ç®¡ç†ã€æ—¥å¿—ç®¡ç†ç­‰

### é€‚ç”¨åœºæ™¯
- ä¸­å°å‹åˆ¶é€ ä¼ä¸š
- è´¸æ˜“å…¬å¸
- é›¶å”®è¿é”åº—
- ä»“å‚¨ç‰©æµä¼ä¸š
- éœ€è¦è¿›é”€å­˜ç®¡ç†çš„å„ç±»ä¼ä¸š

## æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šVue.js 2.x + Ant Design Vue
- **æ„å»ºå·¥å…·**ï¼šVue CLI + Webpack
- **å¼€å‘æœåŠ¡å™¨**ï¼šNode.js + Express

### åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šSpring Boot 2.x
- **ORM**ï¼šMyBatis Plus
- **æ•°æ®åº“**ï¼šMySQL 5.7+
- **ç¼“å­˜**ï¼šRedis 6.x
- **Java ç‰ˆæœ¬**ï¼šJDK 8

### å®¹å™¨åŒ–æ¶æ„
- **å®¹å™¨å¼•æ“**ï¼šDocker + Docker Compose
- **åå‘ä»£ç†**ï¼šNginx
- **ç½‘ç»œæ¨¡å¼**ï¼šè‡ªå®šä¹‰ Docker ç½‘ç»œ
- **æ•°æ®æŒä¹…åŒ–**ï¼šDocker Volumes

## ç¯å¢ƒè¦æ±‚

### ç¡¬ä»¶è¦æ±‚
- **CPU**ï¼š2æ ¸å¿ƒä»¥ä¸Š
- **å†…å­˜**ï¼š4GB ä»¥ä¸Šï¼ˆæ¨è 8GBï¼‰
- **å­˜å‚¨**ï¼š20GB å¯ç”¨ç©ºé—´
- **ç½‘ç»œ**ï¼šç¨³å®šçš„äº’è”ç½‘è¿æ¥

### è½¯ä»¶ä¾èµ–
- **æ“ä½œç³»ç»Ÿ**ï¼šLinux/macOS/Windows
- **Docker**ï¼š20.10+ ç‰ˆæœ¬
- **Docker Compose**ï¼š2.0+ ç‰ˆæœ¬
- **Python 3**ï¼šç”¨äºè„šæœ¬æ‰§è¡Œï¼ˆå¯é€‰ï¼‰

### ç«¯å£éœ€æ±‚
- **3000**ï¼šå‰ç«¯æœåŠ¡
- **9999**ï¼šåç«¯ API æœåŠ¡
- **3306**ï¼šMySQL æ•°æ®åº“
- **6379**ï¼šRedis ç¼“å­˜
- **80**ï¼šNginx åå‘ä»£ç†

## å®Œæ•´éƒ¨ç½²æŒ‡å—

### å¿«é€Ÿéƒ¨ç½²è„šæœ¬

åˆ›å»º `deploy.sh` è„šæœ¬ï¼š

```bash
#!/bin/bash
set -e

echo "=== jshERP ç³»ç»Ÿå¿«é€Ÿéƒ¨ç½²è„šæœ¬ ==="

# 1. æ£€æŸ¥ Docker ç¯å¢ƒ
if ! command -v docker &> /dev/null; then
    echo "é”™è¯¯ï¼šDocker æœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£… Docker"
    exit 1
fi

if ! command -v docker-compose &> /dev/null; then
    echo "é”™è¯¯ï¼šDocker Compose æœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£… Docker Compose"
    exit 1
fi

# 2. è¿›å…¥é¡¹ç›®ç›®å½•
PROJECT_DIR="/Users/macmini/Desktop/jshERP-0612-Cursor"
cd "$PROJECT_DIR"

echo "å½“å‰å·¥ä½œç›®å½•ï¼š$(pwd)"

# 3. ä¿®æ”¹ MyBatis é…ç½®
echo "ä¿®æ”¹ MyBatis æ˜ å°„æ–‡ä»¶é…ç½®..."
sed -i.bak 's/classpath\*:\/mapper_xml\/\*Mapper\.xml/classpath*:\/mapper_xml\/\*.xml/g' \
    jshERP-boot/src/main/resources/application-docker.properties

# 4. å¯åŠ¨åŸºç¡€æœåŠ¡
echo "å¯åŠ¨åŸºç¡€æœåŠ¡ï¼ˆMySQL, Redis, Nginxï¼‰..."
docker-compose -f docker-compose.dev.yml up -d jsherp-mysql-dev jsherp-redis-dev jsherp-nginx-dev

# 5. ç­‰å¾…æ•°æ®åº“å¯åŠ¨
echo "ç­‰å¾…æ•°æ®åº“å¯åŠ¨..."
sleep 30

# 6. å¯¼å…¥æ•°æ®åº“
echo "å¯¼å…¥æ•°æ®åº“..."
docker exec -i jsherp-mysql-dev mysql -u root -p123456 jsh_erp < \
    jshERP-boot/docs/jsh_erp_2025-06-11_06-43-53_mysql_data_pbMor.sql

# 7. æ›´æ–°æ•°æ®åº“è¡¨ç»“æ„
echo "æ›´æ–°æ•°æ®åº“è¡¨ç»“æ„..."
docker exec jsherp-mysql-dev mysql -u root -p123456 -e "
ALTER TABLE jsh_erp.jsh_system_config ADD COLUMN IF NOT EXISTS zero_change_amount_flag varchar(1) DEFAULT '0' COMMENT 'é›¶æ”¶ä»˜æ¬¾å¯ç”¨æ ‡è®°ï¼Œ0æœªå¯ç”¨ï¼Œ1å¯ç”¨' AFTER audit_print_flag;
ALTER TABLE jsh_erp.jsh_system_config ADD COLUMN IF NOT EXISTS customer_static_price_flag varchar(1) DEFAULT '0' COMMENT 'å®¢æˆ·é™æ€å•ä»·å¯ç”¨æ ‡è®°ï¼Œ0æœªå¯ç”¨ï¼Œ1å¯ç”¨' AFTER zero_change_amount_flag;
"

# 8. å¯åŠ¨åç«¯æœåŠ¡
echo "å¯åŠ¨åç«¯æœåŠ¡..."
docker-compose -f docker-compose.dev.yml up -d jsherp-backend-dev

# 9. ç­‰å¾…åç«¯å¯åŠ¨
echo "ç­‰å¾…åç«¯æœåŠ¡å¯åŠ¨..."
sleep 45

# 10. ä¿®å¤å‰ç«¯ä»£ç†é…ç½®
echo "ä¿®å¤å‰ç«¯ä»£ç†é…ç½®..."
docker exec jsherp-frontend-dev sed -i 's/http:\/\/localhost:9999/http:\/\/jsherp-backend-dev:9999/g' vue.config.js || true

# 11. å¯åŠ¨å‰ç«¯æœåŠ¡
echo "å¯åŠ¨å‰ç«¯æœåŠ¡..."
docker-compose -f docker-compose.dev.yml up -d jsherp-frontend-dev

# 12. éªŒè¯éƒ¨ç½²
echo "éªŒè¯éƒ¨ç½²çŠ¶æ€..."
sleep 30

echo "=== éƒ¨ç½²å®Œæˆ ==="
echo "å‰ç«¯è®¿é—®åœ°å€ï¼šhttp://localhost:3000"
echo "åç«¯ API åœ°å€ï¼šhttp://localhost:9999/jshERP-boot"
echo "é»˜è®¤è´¦å·ï¼šadmin / 123456"
echo ""
echo "æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š"
docker-compose -f docker-compose.dev.yml ps
```

### è¯¦ç»†éƒ¨ç½²æ­¥éª¤

#### æ­¥éª¤ 1ï¼šç¯å¢ƒå‡†å¤‡
```bash
# æ£€æŸ¥ Docker ç‰ˆæœ¬
docker --version
docker-compose --version

# ç¡®ä¿ç«¯å£æœªè¢«å ç”¨
netstat -tulpn | grep -E ':(3000|9999|3306|6379|80)\s'
```

#### æ­¥éª¤ 2ï¼šè·å–é¡¹ç›®ä»£ç 
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/macmini/Desktop/jshERP-0612-Cursor

# éªŒè¯é¡¹ç›®ç»“æ„
ls -la
```

**é¢„æœŸç»“æœ**ï¼šåº”è¯¥çœ‹åˆ° `jshERP-boot`ã€`jshERP-web`ã€`docker-compose.dev.yml` ç­‰ç›®å½•å’Œæ–‡ä»¶ã€‚

#### æ­¥éª¤ 3ï¼šä¿®æ”¹å…³é”®é…ç½®
```bash
# ä¿®æ”¹ MyBatis æ˜ å°„æ–‡ä»¶é…ç½®
sed -i.bak 's/classpath\*:\/mapper_xml\/\*Mapper\.xml/classpath*:\/mapper_xml\/\*.xml/g' \
    jshERP-boot/src/main/resources/application-docker.properties

# éªŒè¯ä¿®æ”¹ç»“æœ
grep "mapper-locations" jshERP-boot/src/main/resources/application-docker.properties
```

**é¢„æœŸç»“æœ**ï¼šåº”è¯¥æ˜¾ç¤º `mybatis-plus.mapper-locations=classpath*:/mapper_xml/*.xml`

#### æ­¥éª¤ 4ï¼šå¯åŠ¨åŸºç¡€æœåŠ¡
```bash
# å¯åŠ¨ MySQLã€Redisã€Nginx
docker-compose -f docker-compose.dev.yml up -d jsherp-mysql-dev jsherp-redis-dev jsherp-nginx-dev

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.dev.yml ps
```

**é¢„æœŸç»“æœ**ï¼šä¸‰ä¸ªæœåŠ¡çŠ¶æ€åº”è¯¥ä¸º "Up"ã€‚

#### æ­¥éª¤ 5ï¼šæ•°æ®åº“åˆå§‹åŒ–
```bash
# ç­‰å¾…æ•°æ®åº“å®Œå…¨å¯åŠ¨
sleep 30

# æµ‹è¯•æ•°æ®åº“è¿æ¥
docker exec jsherp-mysql-dev mysql -u root -p123456 -e "SELECT 1"

# å¯¼å…¥æ•°æ®åº“
docker exec -i jsherp-mysql-dev mysql -u root -p123456 jsh_erp < \
    jshERP-boot/docs/jsh_erp_2025-06-11_06-43-53_mysql_data_pbMor.sql
```

**é¢„æœŸç»“æœ**ï¼šæ•°æ®åº“å¯¼å…¥æˆåŠŸï¼Œæ— é”™è¯¯ä¿¡æ¯ã€‚

#### æ­¥éª¤ 6ï¼šæ•°æ®åº“è¡¨ç»“æ„æ›´æ–°
```bash
# æ·»åŠ ç¼ºå¤±çš„å­—æ®µ
docker exec jsherp-mysql-dev mysql -u root -p123456 -e "
ALTER TABLE jsh_erp.jsh_system_config ADD COLUMN IF NOT EXISTS zero_change_amount_flag varchar(1) DEFAULT '0' COMMENT 'é›¶æ”¶ä»˜æ¬¾å¯ç”¨æ ‡è®°ï¼Œ0æœªå¯ç”¨ï¼Œ1å¯ç”¨' AFTER audit_print_flag;
ALTER TABLE jsh_erp.jsh_system_config ADD COLUMN IF NOT EXISTS customer_static_price_flag varchar(1) DEFAULT '0' COMMENT 'å®¢æˆ·é™æ€å•ä»·å¯ç”¨æ ‡è®°ï¼Œ0æœªå¯ç”¨ï¼Œ1å¯ç”¨' AFTER zero_change_amount_flag;
"

# éªŒè¯è¡¨ç»“æ„
docker exec jsherp-mysql-dev mysql -u root -p123456 -e "DESCRIBE jsh_erp.jsh_system_config;" | tail -5
```

**é¢„æœŸç»“æœ**ï¼šåº”è¯¥çœ‹åˆ°æ–°æ·»åŠ çš„ä¸¤ä¸ªå­—æ®µã€‚

#### æ­¥éª¤ 7ï¼šå¯åŠ¨åç«¯æœåŠ¡
```bash
# å¯åŠ¨åç«¯
docker-compose -f docker-compose.dev.yml up -d jsherp-backend-dev

# ç›‘æ§å¯åŠ¨æ—¥å¿—
docker logs -f jsherp-backend-dev
```

**é¢„æœŸç»“æœ**ï¼šçœ‹åˆ° "Started ErpApplication" è¡¨ç¤ºå¯åŠ¨æˆåŠŸã€‚

#### æ­¥éª¤ 8ï¼šä¿®å¤å‰ç«¯é…ç½®å¹¶å¯åŠ¨
```bash
# ç­‰å¾…åç«¯å®Œå…¨å¯åŠ¨
sleep 45

# ä¿®å¤å‰ç«¯ä»£ç†é…ç½®
docker exec jsherp-frontend-dev sed -i 's/http:\/\/localhost:9999/http:\/\/jsherp-backend-dev:9999/g' vue.config.js

# å¯åŠ¨å‰ç«¯
docker-compose -f docker-compose.dev.yml up -d jsherp-frontend-dev

# æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.dev.yml ps
```

**é¢„æœŸç»“æœ**ï¼šæ‰€æœ‰æœåŠ¡çŠ¶æ€ä¸º "Up"ã€‚

#### æ­¥éª¤ 9ï¼šåŠŸèƒ½éªŒè¯
```bash
# æµ‹è¯•éªŒè¯ç æ¥å£
curl -s http://localhost:3000/jshERP-boot/user/randomImage | head -c 100

# æµ‹è¯•å‰ç«¯é¡µé¢
curl -s -o /dev/null -w "%{http_code}" http://localhost:3000
```

**é¢„æœŸç»“æœ**ï¼šéªŒè¯ç æ¥å£è¿”å› JSON æ•°æ®ï¼Œå‰ç«¯é¡µé¢è¿”å› 200 çŠ¶æ€ç ã€‚

## é—®é¢˜è¯Šæ–­ä¸è§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1ï¼šMyBatis æ˜ å°„æ–‡ä»¶åŠ è½½å¤±è´¥

#### é—®é¢˜ç°è±¡
```
org.apache.ibatis.binding.BindingException: Invalid bound statement (not found):
com.jsh.erp.datasource.mappers.LogMapperEx.insertLogWithUserId
```

#### æ ¹æœ¬åŸå› 
Docker ç¯å¢ƒé…ç½®æ–‡ä»¶ä¸­ MyBatis æ˜ å°„æ–‡ä»¶è·¯å¾„é…ç½®é”™è¯¯ï¼ŒåªåŠ è½½ `*Mapper.xml` æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬ `*MapperEx.xml` æ‰©å±•æ–‡ä»¶ã€‚

#### è§£å†³æ–¹æ¡ˆ
1. **å®šä½é…ç½®æ–‡ä»¶**ï¼š
   ```bash
   vim jshERP-boot/src/main/resources/application-docker.properties
   ```

2. **ä¿®æ”¹é…ç½®**ï¼š
   ```properties
   # ä¿®æ”¹å‰ï¼ˆé”™è¯¯ï¼‰
   mybatis-plus.mapper-locations=classpath*:/mapper_xml/*Mapper.xml

   # ä¿®æ”¹åï¼ˆæ­£ç¡®ï¼‰
   mybatis-plus.mapper-locations=classpath*:/mapper_xml/*.xml
   ```

3. **éªŒè¯ä¿®å¤**ï¼š
   ```bash
   # é‡å¯åç«¯æœåŠ¡
   docker-compose -f docker-compose.dev.yml restart jsherp-backend-dev

   # æ£€æŸ¥æ—¥å¿—ç¡®è®¤æ˜ å°„æ–‡ä»¶åŠ è½½æˆåŠŸ
   docker logs jsherp-backend-dev | grep -i mapper
   ```

#### é¢„é˜²æªæ–½
- éƒ¨ç½²å‰å¯¹æ¯”ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒçš„é…ç½®æ–‡ä»¶å·®å¼‚
- å»ºç«‹é…ç½®æ–‡ä»¶ç‰ˆæœ¬ç®¡ç†æœºåˆ¶

### é—®é¢˜ 2ï¼šæ•°æ®åº“è¡¨ç»“æ„ä¸ä»£ç ä¸åŒ¹é…

#### é—®é¢˜ç°è±¡
```
com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException:
Unknown column 'zero_change_amount_flag' in 'field list'
```

#### æ ¹æœ¬åŸå› 
ä»£ç ä¸­çš„å®ä½“ç±»åŒ…å«äº†æ–°ç‰ˆæœ¬çš„å­—æ®µï¼Œä½†æ•°æ®åº“è¡¨ç»“æ„è¿˜æ˜¯æ—§ç‰ˆæœ¬ï¼Œç¼ºå°‘å¯¹åº”å­—æ®µã€‚

#### è§£å†³æ–¹æ¡ˆ
1. **æ£€æŸ¥ç¼ºå¤±å­—æ®µ**ï¼š
   ```bash
   # æŸ¥çœ‹å½“å‰è¡¨ç»“æ„
   docker exec jsherp-mysql-dev mysql -u root -p123456 -e "DESCRIBE jsh_erp.jsh_system_config;"
   ```

2. **æ‰§è¡Œæ•°æ®åº“å‡çº§**ï¼š
   ```sql
   ALTER TABLE jsh_system_config ADD COLUMN zero_change_amount_flag varchar(1) DEFAULT '0'
   COMMENT 'é›¶æ”¶ä»˜æ¬¾å¯ç”¨æ ‡è®°ï¼Œ0æœªå¯ç”¨ï¼Œ1å¯ç”¨' AFTER audit_print_flag;

   ALTER TABLE jsh_system_config ADD COLUMN customer_static_price_flag varchar(1) DEFAULT '0'
   COMMENT 'å®¢æˆ·é™æ€å•ä»·å¯ç”¨æ ‡è®°ï¼Œ0æœªå¯ç”¨ï¼Œ1å¯ç”¨' AFTER zero_change_amount_flag;
   ```

3. **éªŒè¯ä¿®å¤**ï¼š
   ```bash
   # æ£€æŸ¥å­—æ®µæ˜¯å¦æ·»åŠ æˆåŠŸ
   docker exec jsherp-mysql-dev mysql -u root -p123456 -e "SHOW COLUMNS FROM jsh_erp.jsh_system_config LIKE '%flag%';"
   ```

#### é¢„é˜²æªæ–½
- å»ºç«‹æ•°æ®åº“ç‰ˆæœ¬ç®¡ç†æœºåˆ¶
- éƒ¨ç½²å‰æ£€æŸ¥æ•°æ®åº“å‡çº§è„šæœ¬
- ä½¿ç”¨è‡ªåŠ¨åŒ–æ•°æ®åº“è¿ç§»å·¥å…·

### é—®é¢˜ 3ï¼šéªŒè¯ç æ˜¾ç¤ºå¼‚å¸¸

#### é—®é¢˜ç°è±¡
éªŒè¯ç æ¥å£è¿”å› 500 é”™è¯¯ï¼Œå‰ç«¯æ— æ³•æ˜¾ç¤ºéªŒè¯ç å›¾ç‰‡ã€‚

#### æ ¹æœ¬åŸå› 
Docker å®¹å™¨ä¸­ç¼ºå°‘å›¾å½¢å­—ä½“åº“ï¼ŒJava AWT æ— æ³•åœ¨æ— å›¾å½¢ç¯å¢ƒä¸­ç”ŸæˆéªŒè¯ç å›¾ç‰‡ã€‚

#### è§£å†³æ–¹æ¡ˆ
1. **ä¿®æ”¹éªŒè¯ç ç”Ÿæˆé€»è¾‘**ï¼š
   ```java
   // åœ¨ UserController.randomImage() æ–¹æ³•ä¸­æ·»åŠ  SVG éªŒè¯ç ç”Ÿæˆ
   private String generateSimpleSvgCaptcha(String codeNum) {
       StringBuilder svg = new StringBuilder();
       svg.append("<svg width='105' height='35' xmlns='http://www.w3.org/2000/svg'>");
       svg.append("<rect width='105' height='35' fill='#f8f9fa' stroke='#dee2e6'/>");

       // æ·»åŠ éªŒè¯ç æ–‡å­—
       for (int i = 0; i < codeNum.length(); i++) {
           char c = codeNum.charAt(i);
           int x = 15 + i * 20;
           int y = 22;
           svg.append("<text x='").append(x).append("' y='").append(y)
              .append("' font-family='Arial,sans-serif' font-size='18' font-weight='bold' fill='#495057'>")
              .append(c).append("</text>");
       }

       svg.append("</svg>");
       String svgBase64 = java.util.Base64.getEncoder().encodeToString(svg.toString().getBytes());
       return "data:image/svg+xml;base64," + svgBase64;
   }
   ```

2. **éªŒè¯ä¿®å¤**ï¼š
   ```bash
   # æµ‹è¯•éªŒè¯ç æ¥å£
   curl -s http://localhost:3000/jshERP-boot/user/randomImage
   ```

#### é¢„é˜²æªæ–½
- å®¹å™¨åŒ–åº”ç”¨é¿å…ä¾èµ–å›¾å½¢åº“
- ä½¿ç”¨çº¯æ–‡æœ¬æˆ– SVG æ›¿ä»£æ–¹æ¡ˆ
- åœ¨å®¹å™¨ä¸­å®‰è£…å¿…è¦çš„å­—ä½“åº“

### é—®é¢˜ 4ï¼šå‰åç«¯ç½‘ç»œé€šä¿¡å¤±è´¥

#### é—®é¢˜ç°è±¡
å‰ç«¯é¡µé¢å¯ä»¥è®¿é—®ï¼Œä½†æ— æ³•è°ƒç”¨åç«¯ APIï¼ŒéªŒè¯ç å’Œç™»å½•åŠŸèƒ½å¤±æ•ˆã€‚

#### æ ¹æœ¬åŸå› 
å‰ç«¯å®¹å™¨ä¸­çš„ä»£ç†é…ç½®ä½¿ç”¨ `localhost`ï¼Œåœ¨ Docker ç½‘ç»œä¸­æ— æ³•è®¿é—®åç«¯å®¹å™¨ã€‚

#### è§£å†³æ–¹æ¡ˆ
1. **æ£€æŸ¥ç½‘ç»œé…ç½®**ï¼š
   ```bash
   # æŸ¥çœ‹å®¹å™¨ç½‘ç»œ
   docker network ls
   docker inspect jsherp_network_dev
   ```

2. **ä¿®å¤ä»£ç†é…ç½®**ï¼š
   ```bash
   # ä¿®æ”¹å‰ç«¯å®¹å™¨ä¸­çš„ä»£ç†é…ç½®
   docker exec jsherp-frontend-dev sed -i 's/http:\/\/localhost:9999/http:\/\/jsherp-backend-dev:9999/g' vue.config.js

   # é‡å¯å‰ç«¯æœåŠ¡
   docker-compose -f docker-compose.dev.yml restart jsherp-frontend-dev
   ```

3. **éªŒè¯ä¿®å¤**ï¼š
   ```bash
   # æµ‹è¯•å‰ç«¯åˆ°åç«¯çš„è¿æ¥
   curl -s http://localhost:3000/jshERP-boot/user/randomImage
   ```

#### é¢„é˜²æªæ–½
- å®¹å™¨åŒ–åº”ç”¨ä½¿ç”¨å®¹å™¨åè¿›è¡Œå†…éƒ¨é€šä¿¡
- å»ºç«‹ç»Ÿä¸€çš„ç½‘ç»œé…ç½®ç®¡ç†
- ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†ä¸åŒç¯å¢ƒçš„é…ç½®

### é€šç”¨æ•…éšœæ’æŸ¥æ–¹æ³•è®º

#### 1. æ—¥å¿—åˆ†ææ³•
```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs jsherp-backend-dev --tail 50
docker logs jsherp-frontend-dev --tail 50

# å®æ—¶ç›‘æ§æ—¥å¿—
docker logs -f jsherp-backend-dev
```

#### 2. ç½‘ç»œè¿é€šæ€§æµ‹è¯•
```bash
# æµ‹è¯•å®¹å™¨é—´ç½‘ç»œè¿é€šæ€§
docker exec jsherp-frontend-dev ping jsherp-backend-dev
docker exec jsherp-backend-dev ping jsherp-mysql-dev

# æµ‹è¯•ç«¯å£å¯è¾¾æ€§
docker exec jsherp-frontend-dev telnet jsherp-backend-dev 9999
```

#### 3. é…ç½®æ–‡ä»¶å¯¹æ¯”
```bash
# å¯¹æ¯”é…ç½®æ–‡ä»¶å·®å¼‚
diff jshERP-boot/src/main/resources/application.properties \
     jshERP-boot/src/main/resources/application-docker.properties
```

#### 4. æ•°æ®åº“è¿æ¥æµ‹è¯•
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
docker exec jsherp-mysql-dev mysql -u root -p123456 -e "SELECT 1"

# æ£€æŸ¥æ•°æ®åº“è¡¨ç»“æ„
docker exec jsherp-mysql-dev mysql -u root -p123456 -e "SHOW TABLES FROM jsh_erp"
```

#### 5. æœåŠ¡å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.dev.yml ps

# æ£€æŸ¥å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ
docker stats
```

## ç³»ç»Ÿè®¿é—®ä¿¡æ¯

### ğŸŒ è®¿é—®åœ°å€
- **å‰ç«¯ç³»ç»Ÿ**ï¼šhttp://localhost:3000
- **åç«¯ API**ï¼šhttp://localhost:9999/jshERP-boot
- **API æ–‡æ¡£**ï¼šhttp://localhost:9999/jshERP-boot/doc.html
- **Swagger æ–‡æ¡£**ï¼šhttp://localhost:9999/jshERP-boot/swagger-ui.html

### ğŸ‘¤ æµ‹è¯•è´¦å·
| è§’è‰² | ç”¨æˆ·å | å¯†ç  | æƒé™è¯´æ˜ |
|------|--------|------|----------|
| ç³»ç»Ÿç®¡ç†å‘˜ | admin | 123456 | æ‹¥æœ‰æ‰€æœ‰åŠŸèƒ½æƒé™ |
| ç§Ÿæˆ·ç®¡ç†å‘˜ | waterxi | 123456 | ç§Ÿæˆ·çº§åˆ«ç®¡ç†æƒé™ |

### ğŸ—„ï¸ æ•°æ®åº“è¿æ¥ä¿¡æ¯
- **ä¸»æœº**ï¼šlocalhost:3306
- **æ•°æ®åº“å**ï¼šjsh_erp
- **ç”¨æˆ·å**ï¼šroot
- **å¯†ç **ï¼š123456
- **å­—ç¬¦é›†**ï¼šutf8

### ğŸ“Š Redis è¿æ¥ä¿¡æ¯
- **ä¸»æœº**ï¼šlocalhost:6379
- **å¯†ç **ï¼š1234abcd
- **æ•°æ®åº“**ï¼š0ï¼ˆé»˜è®¤ï¼‰

### ğŸ³ Docker æœåŠ¡ä¿¡æ¯
| æœåŠ¡å | å®¹å™¨å | ç«¯å£æ˜ å°„ | çŠ¶æ€æ£€æŸ¥ |
|--------|--------|----------|----------|
| å‰ç«¯æœåŠ¡ | jsherp-frontend-dev | 3000:3000 | http://localhost:3000 |
| åç«¯æœåŠ¡ | jsherp-backend-dev | 9999:9999 | http://localhost:9999/jshERP-boot |
| MySQL | jsherp-mysql-dev | 3306:3306 | `docker exec jsherp-mysql-dev mysql -u root -p123456 -e "SELECT 1"` |
| Redis | jsherp-redis-dev | 6379:6379 | `docker exec jsherp-redis-dev redis-cli -a 1234abcd ping` |
| Nginx | jsherp-nginx-dev | 80:80 | http://localhost |

## åŠŸèƒ½éªŒè¯æ¸…å•

### âœ… åŸºç¡€åŠŸèƒ½éªŒè¯

#### 1. ç³»ç»Ÿç™»å½•éªŒè¯
```bash
# è®¿é—®ç™»å½•é¡µé¢
curl -s -o /dev/null -w "%{http_code}" http://localhost:3000

# è·å–éªŒè¯ç 
curl -s http://localhost:3000/jshERP-boot/user/randomImage | head -c 100

# æµ‹è¯•ç™»å½•ï¼ˆéœ€è¦çœŸå®éªŒè¯ç ï¼‰
# åœ¨æµè§ˆå™¨ä¸­æ‰‹åŠ¨æµ‹è¯•ï¼šç”¨æˆ·å adminï¼Œå¯†ç  123456
```

#### 2. èœå•æƒé™éªŒè¯
- [ ] é›¶å”®ç®¡ç†æ¨¡å—å¯è®¿é—®
- [ ] é‡‡è´­ç®¡ç†æ¨¡å—å¯è®¿é—®
- [ ] é”€å”®ç®¡ç†æ¨¡å—å¯è®¿é—®
- [ ] ä»“åº“ç®¡ç†æ¨¡å—å¯è®¿é—®
- [ ] è´¢åŠ¡ç®¡ç†æ¨¡å—å¯è®¿é—®
- [ ] æŠ¥è¡¨æŸ¥è¯¢æ¨¡å—å¯è®¿é—®
- [ ] å•†å“ç®¡ç†æ¨¡å—å¯è®¿é—®
- [ ] åŸºç¡€èµ„æ–™æ¨¡å—å¯è®¿é—®
- [ ] ç³»ç»Ÿç®¡ç†æ¨¡å—å¯è®¿é—®

#### 3. æ•°æ®åº“è¿æ¥éªŒè¯
```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
docker exec jsherp-mysql-dev mysql -u root -p123456 -e "SELECT COUNT(*) FROM jsh_erp.jsh_user"

# æ£€æŸ¥å…³é”®è¡¨æ•°æ®
docker exec jsherp-mysql-dev mysql -u root -p123456 -e "
SELECT table_name, table_rows
FROM information_schema.tables
WHERE table_schema = 'jsh_erp'
ORDER BY table_rows DESC
LIMIT 10"
```

#### 4. ç¼“å­˜æœåŠ¡éªŒè¯
```bash
# æ£€æŸ¥ Redis è¿æ¥
docker exec jsherp-redis-dev redis-cli -a 1234abcd ping

# æ£€æŸ¥éªŒè¯ç ç¼“å­˜
docker exec jsherp-redis-dev redis-cli -a 1234abcd keys "*captcha*"
```

### âœ… ä¸šåŠ¡åŠŸèƒ½éªŒè¯

#### 1. å•†å“ç®¡ç†
- [ ] åˆ›å»ºå•†å“ç±»åˆ«
- [ ] æ·»åŠ å•†å“ä¿¡æ¯
- [ ] è®¾ç½®å¤šå•ä½
- [ ] é…ç½®å¤šå±æ€§

#### 2. åŸºç¡€èµ„æ–™
- [ ] æ·»åŠ ä¾›åº”å•†ä¿¡æ¯
- [ ] æ·»åŠ å®¢æˆ·ä¿¡æ¯
- [ ] è®¾ç½®ä»“åº“ä¿¡æ¯
- [ ] é…ç½®ç»“ç®—è´¦æˆ·

#### 3. é‡‡è´­æµç¨‹
- [ ] åˆ›å»ºé‡‡è´­è®¢å•
- [ ] é‡‡è´­å…¥åº“æ“ä½œ
- [ ] é‡‡è´­é€€è´§å¤„ç†

#### 4. é”€å”®æµç¨‹
- [ ] åˆ›å»ºé”€å”®è®¢å•
- [ ] é”€å”®å‡ºåº“æ“ä½œ
- [ ] é”€å”®é€€è´§å¤„ç†

#### 5. åº“å­˜ç®¡ç†
- [ ] æŸ¥çœ‹å•†å“åº“å­˜
- [ ] å…¶å®ƒå…¥åº“æ“ä½œ
- [ ] è°ƒæ‹¨å‡ºåº“æ“ä½œ

#### 6. è´¢åŠ¡ç®¡ç†
- [ ] åˆ›å»ºæ”¶æ¬¾å•
- [ ] åˆ›å»ºä»˜æ¬¾å•
- [ ] æŸ¥çœ‹è´¦æˆ·ç»Ÿè®¡

#### 7. æŠ¥è¡¨åŠŸèƒ½
- [ ] æŸ¥çœ‹è¿›é”€å­˜ç»Ÿè®¡
- [ ] æŸ¥çœ‹é‡‡è´­ç»Ÿè®¡
- [ ] æŸ¥çœ‹é”€å”®ç»Ÿè®¡
- [ ] æŸ¥çœ‹åº“å­˜é¢„è­¦

### âœ… æ€§èƒ½éªŒè¯

#### 1. å“åº”æ—¶é—´æµ‹è¯•
```bash
# æµ‹è¯•é¡µé¢åŠ è½½æ—¶é—´
time curl -s http://localhost:3000 > /dev/null

# æµ‹è¯• API å“åº”æ—¶é—´
time curl -s http://localhost:9999/jshERP-boot/user/getUserSession > /dev/null
```

#### 2. å¹¶å‘æµ‹è¯•
```bash
# ç®€å•å¹¶å‘æµ‹è¯•ï¼ˆéœ€è¦å®‰è£… ab å·¥å…·ï¼‰
ab -n 100 -c 10 http://localhost:3000/

# æˆ–ä½¿ç”¨ curl è¿›è¡Œç®€å•æµ‹è¯•
for i in {1..10}; do
  curl -s http://localhost:3000 > /dev/null &
done
wait
```

#### 3. èµ„æºä½¿ç”¨ç›‘æ§
```bash
# ç›‘æ§å®¹å™¨èµ„æºä½¿ç”¨
docker stats --no-stream

# æ£€æŸ¥ç£ç›˜ä½¿ç”¨
docker system df
```

## ç»´æŠ¤ä¸è¿ç»´æŒ‡å—

### ğŸ”§ æ—¥å¸¸ç»´æŠ¤å‘½ä»¤

#### æœåŠ¡ç®¡ç†
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.dev.yml ps

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.dev.yml up -d

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.dev.yml down

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose -f docker-compose.dev.yml restart jsherp-backend-dev

# æŸ¥çœ‹æœåŠ¡èµ„æºä½¿ç”¨æƒ…å†µ
docker stats
```

#### æ—¥å¿—ç®¡ç†
```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
docker logs jsherp-backend-dev --tail 100

# å®æ—¶ç›‘æ§æ—¥å¿—
docker logs -f jsherp-backend-dev

# æŸ¥çœ‹å‰ç«¯æ—¥å¿—
docker logs jsherp-frontend-dev --tail 50

# æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker logs jsherp-mysql-dev --tail 50

# å¯¼å‡ºæ—¥å¿—åˆ°æ–‡ä»¶
docker logs jsherp-backend-dev > backend.log 2>&1
```

#### æ•°æ®åº“ç»´æŠ¤
```bash
# è¿æ¥æ•°æ®åº“
docker exec -it jsherp-mysql-dev mysql -u root -p123456

# å¤‡ä»½æ•°æ®åº“
docker exec jsherp-mysql-dev mysqldump -u root -p123456 jsh_erp > backup_$(date +%Y%m%d_%H%M%S).sql

# æ¢å¤æ•°æ®åº“
docker exec -i jsherp-mysql-dev mysql -u root -p123456 jsh_erp < backup_file.sql

# æ£€æŸ¥æ•°æ®åº“å¤§å°
docker exec jsherp-mysql-dev mysql -u root -p123456 -e "
SELECT
    table_schema AS 'Database',
    ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS 'Size (MB)'
FROM information_schema.tables
WHERE table_schema = 'jsh_erp'
GROUP BY table_schema;"
```

#### ç¼“å­˜ç®¡ç†
```bash
# è¿æ¥ Redis
docker exec -it jsherp-redis-dev redis-cli -a 1234abcd

# æ¸…ç©ºç¼“å­˜
docker exec jsherp-redis-dev redis-cli -a 1234abcd FLUSHALL

# æŸ¥çœ‹ç¼“å­˜ä½¿ç”¨æƒ…å†µ
docker exec jsherp-redis-dev redis-cli -a 1234abcd INFO memory

# æŸ¥çœ‹æ‰€æœ‰é”®
docker exec jsherp-redis-dev redis-cli -a 1234abcd KEYS "*"
```

### ğŸ“Š ç›‘æ§ä¸å‘Šè­¦

#### å¥åº·æ£€æŸ¥è„šæœ¬
åˆ›å»º `health_check.sh`ï¼š

```bash
#!/bin/bash

echo "=== jshERP ç³»ç»Ÿå¥åº·æ£€æŸ¥ ==="

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
echo "1. æ£€æŸ¥å®¹å™¨çŠ¶æ€..."
docker-compose -f docker-compose.dev.yml ps

# æ£€æŸ¥å‰ç«¯æœåŠ¡
echo "2. æ£€æŸ¥å‰ç«¯æœåŠ¡..."
FRONTEND_STATUS=$(curl -s -o /dev/null -w "%{http_code}" http://localhost:3000)
if [ "$FRONTEND_STATUS" = "200" ]; then
    echo "âœ… å‰ç«¯æœåŠ¡æ­£å¸¸"
else
    echo "âŒ å‰ç«¯æœåŠ¡å¼‚å¸¸ï¼ŒçŠ¶æ€ç ï¼š$FRONTEND_STATUS"
fi

# æ£€æŸ¥åç«¯æœåŠ¡
echo "3. æ£€æŸ¥åç«¯æœåŠ¡..."
BACKEND_STATUS=$(curl -s -o /dev/null -w "%{http_code}" http://localhost:9999/jshERP-boot/user/randomImage)
if [ "$BACKEND_STATUS" = "200" ]; then
    echo "âœ… åç«¯æœåŠ¡æ­£å¸¸"
else
    echo "âŒ åç«¯æœåŠ¡å¼‚å¸¸ï¼ŒçŠ¶æ€ç ï¼š$BACKEND_STATUS"
fi

# æ£€æŸ¥æ•°æ®åº“è¿æ¥
echo "4. æ£€æŸ¥æ•°æ®åº“è¿æ¥..."
DB_CHECK=$(docker exec jsherp-mysql-dev mysql -u root -p123456 -e "SELECT 1" 2>/dev/null)
if [ $? -eq 0 ]; then
    echo "âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸"
else
    echo "âŒ æ•°æ®åº“è¿æ¥å¼‚å¸¸"
fi

# æ£€æŸ¥ Redis è¿æ¥
echo "5. æ£€æŸ¥ Redis è¿æ¥..."
REDIS_CHECK=$(docker exec jsherp-redis-dev redis-cli -a 1234abcd ping 2>/dev/null)
if [ "$REDIS_CHECK" = "PONG" ]; then
    echo "âœ… Redis è¿æ¥æ­£å¸¸"
else
    echo "âŒ Redis è¿æ¥å¼‚å¸¸"
fi

# æ£€æŸ¥ç£ç›˜ç©ºé—´
echo "6. æ£€æŸ¥ç£ç›˜ç©ºé—´..."
DISK_USAGE=$(df -h / | awk 'NR==2 {print $5}' | sed 's/%//')
if [ "$DISK_USAGE" -lt 80 ]; then
    echo "âœ… ç£ç›˜ç©ºé—´å……è¶³ ($DISK_USAGE%)"
else
    echo "âš ï¸  ç£ç›˜ç©ºé—´ä¸è¶³ ($DISK_USAGE%)"
fi

echo "=== å¥åº·æ£€æŸ¥å®Œæˆ ==="
```

#### æ€§èƒ½ç›‘æ§
```bash
# åˆ›å»ºæ€§èƒ½ç›‘æ§è„šæœ¬
cat > monitor.sh << 'EOF'
#!/bin/bash

while true; do
    echo "=== $(date) ==="

    # CPU å’Œå†…å­˜ä½¿ç”¨æƒ…å†µ
    docker stats --no-stream --format "table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}\t{{.MemPerc}}"

    # ç£ç›˜ä½¿ç”¨æƒ…å†µ
    echo "ç£ç›˜ä½¿ç”¨ï¼š"
    df -h /

    # ç½‘ç»œè¿æ¥æ•°
    echo "ç½‘ç»œè¿æ¥æ•°ï¼š"
    netstat -an | grep :3000 | wc -l
    netstat -an | grep :9999 | wc -l

    echo "========================"
    sleep 60
done
EOF

chmod +x monitor.sh
```

### ğŸ”„ å¤‡ä»½æ¢å¤æµç¨‹

#### å®Œæ•´å¤‡ä»½è„šæœ¬
åˆ›å»º `backup.sh`ï¼š

```bash
#!/bin/bash

BACKUP_DIR="/backup/jshERP/$(date +%Y%m%d_%H%M%S)"
mkdir -p "$BACKUP_DIR"

echo "å¼€å§‹å¤‡ä»½ jshERP ç³»ç»Ÿ..."

# 1. å¤‡ä»½æ•°æ®åº“
echo "å¤‡ä»½æ•°æ®åº“..."
docker exec jsherp-mysql-dev mysqldump -u root -p123456 --single-transaction jsh_erp > "$BACKUP_DIR/database.sql"

# 2. å¤‡ä»½ Redis æ•°æ®
echo "å¤‡ä»½ Redis æ•°æ®..."
docker exec jsherp-redis-dev redis-cli -a 1234abcd --rdb /data/dump.rdb
docker cp jsherp-redis-dev:/data/dump.rdb "$BACKUP_DIR/redis_dump.rdb"

# 3. å¤‡ä»½é…ç½®æ–‡ä»¶
echo "å¤‡ä»½é…ç½®æ–‡ä»¶..."
cp -r jshERP-boot/src/main/resources/ "$BACKUP_DIR/config/"
cp docker-compose.dev.yml "$BACKUP_DIR/"

# 4. å¤‡ä»½ä¸Šä¼ æ–‡ä»¶ï¼ˆå¦‚æœæœ‰ï¼‰
echo "å¤‡ä»½ä¸Šä¼ æ–‡ä»¶..."
if [ -d "/opt/jshERP/upload" ]; then
    cp -r /opt/jshERP/upload "$BACKUP_DIR/"
fi

# 5. åˆ›å»ºå¤‡ä»½ä¿¡æ¯æ–‡ä»¶
echo "åˆ›å»ºå¤‡ä»½ä¿¡æ¯..."
cat > "$BACKUP_DIR/backup_info.txt" << EOF
å¤‡ä»½æ—¶é—´: $(date)
ç³»ç»Ÿç‰ˆæœ¬: jshERP
æ•°æ®åº“ç‰ˆæœ¬: $(docker exec jsherp-mysql-dev mysql -u root -p123456 -e "SELECT VERSION()" | tail -1)
Redis ç‰ˆæœ¬: $(docker exec jsherp-redis-dev redis-cli -a 1234abcd INFO server | grep redis_version)
å¤‡ä»½å¤§å°: $(du -sh "$BACKUP_DIR" | cut -f1)
EOF

echo "å¤‡ä»½å®Œæˆï¼Œå¤‡ä»½ç›®å½•ï¼š$BACKUP_DIR"
```

#### æ¢å¤è„šæœ¬
åˆ›å»º `restore.sh`ï¼š

```bash
#!/bin/bash

if [ $# -ne 1 ]; then
    echo "ä½¿ç”¨æ–¹æ³•: $0 <å¤‡ä»½ç›®å½•>"
    exit 1
fi

BACKUP_DIR="$1"

if [ ! -d "$BACKUP_DIR" ]; then
    echo "é”™è¯¯ï¼šå¤‡ä»½ç›®å½•ä¸å­˜åœ¨"
    exit 1
fi

echo "å¼€å§‹æ¢å¤ jshERP ç³»ç»Ÿ..."

# 1. åœæ­¢æœåŠ¡
echo "åœæ­¢æœåŠ¡..."
docker-compose -f docker-compose.dev.yml down

# 2. æ¢å¤æ•°æ®åº“
echo "æ¢å¤æ•°æ®åº“..."
docker-compose -f docker-compose.dev.yml up -d jsherp-mysql-dev
sleep 30
docker exec -i jsherp-mysql-dev mysql -u root -p123456 jsh_erp < "$BACKUP_DIR/database.sql"

# 3. æ¢å¤ Redis æ•°æ®
echo "æ¢å¤ Redis æ•°æ®..."
docker-compose -f docker-compose.dev.yml up -d jsherp-redis-dev
sleep 10
docker cp "$BACKUP_DIR/redis_dump.rdb" jsherp-redis-dev:/data/dump.rdb
docker-compose -f docker-compose.dev.yml restart jsherp-redis-dev

# 4. æ¢å¤é…ç½®æ–‡ä»¶
echo "æ¢å¤é…ç½®æ–‡ä»¶..."
cp -r "$BACKUP_DIR/config/"* jshERP-boot/src/main/resources/

# 5. æ¢å¤ä¸Šä¼ æ–‡ä»¶
echo "æ¢å¤ä¸Šä¼ æ–‡ä»¶..."
if [ -d "$BACKUP_DIR/upload" ]; then
    mkdir -p /opt/jshERP/
    cp -r "$BACKUP_DIR/upload" /opt/jshERP/
fi

# 6. å¯åŠ¨æ‰€æœ‰æœåŠ¡
echo "å¯åŠ¨æ‰€æœ‰æœåŠ¡..."
docker-compose -f docker-compose.dev.yml up -d

echo "æ¢å¤å®Œæˆ"
```

## å¸¸è§é—®é¢˜ FAQ

### Q1: å®¹å™¨å¯åŠ¨å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: æŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

1. æ£€æŸ¥ç«¯å£å ç”¨ï¼š
   ```bash
   netstat -tulpn | grep -E ':(3000|9999|3306|6379|80)\s'
   ```

2. æ£€æŸ¥ Docker èµ„æºï¼š
   ```bash
   docker system df
   docker system prune -f
   ```

3. æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š
   ```bash
   docker logs jsherp-backend-dev
   ```

### Q2: å‰ç«¯é¡µé¢æ— æ³•è®¿é—®åç«¯ APIï¼Ÿ

**A**: æ£€æŸ¥ç½‘ç»œé…ç½®ï¼š

1. ç¡®è®¤å®¹å™¨ç½‘ç»œï¼š
   ```bash
   docker network ls
   docker inspect jsherp_network_dev
   ```

2. ä¿®å¤ä»£ç†é…ç½®ï¼š
   ```bash
   docker exec jsherp-frontend-dev sed -i 's/localhost/jsherp-backend-dev/g' vue.config.js
   docker-compose -f docker-compose.dev.yml restart jsherp-frontend-dev
   ```

### Q3: æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ

**A**: æ£€æŸ¥æ•°æ®åº“çŠ¶æ€ï¼š

1. ç¡®è®¤æ•°æ®åº“å¯åŠ¨ï¼š
   ```bash
   docker logs jsherp-mysql-dev
   ```

2. æµ‹è¯•è¿æ¥ï¼š
   ```bash
   docker exec jsherp-mysql-dev mysql -u root -p123456 -e "SELECT 1"
   ```

3. æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯

### Q4: éªŒè¯ç ä¸æ˜¾ç¤ºï¼Ÿ

**A**: è¿™é€šå¸¸æ˜¯å›¾å½¢åº“é—®é¢˜ï¼š

1. æ£€æŸ¥éªŒè¯ç æ¥å£ï¼š
   ```bash
   curl -s http://localhost:3000/jshERP-boot/user/randomImage
   ```

2. å¦‚æœè¿”å›é”™è¯¯ï¼Œè¯´æ˜éœ€è¦ä¿®æ”¹éªŒè¯ç ç”Ÿæˆé€»è¾‘ï¼ˆå‚è€ƒé—®é¢˜è§£å†³æ–¹æ¡ˆéƒ¨åˆ†ï¼‰

### Q5: ç³»ç»Ÿè¿è¡Œç¼“æ…¢ï¼Ÿ

**A**: æ€§èƒ½ä¼˜åŒ–å»ºè®®ï¼š

1. å¢åŠ å®¹å™¨å†…å­˜é™åˆ¶ï¼š
   ```yaml
   # åœ¨ docker-compose.dev.yml ä¸­æ·»åŠ 
   services:
     jsherp-backend-dev:
       mem_limit: 2g
   ```

2. ä¼˜åŒ–æ•°æ®åº“é…ç½®ï¼š
   ```bash
   # å¢åŠ  MySQL ç¼“å­˜
   docker exec jsherp-mysql-dev mysql -u root -p123456 -e "SET GLOBAL innodb_buffer_pool_size=268435456"
   ```

3. æ¸…ç† Docker èµ„æºï¼š
   ```bash
   docker system prune -f
   docker volume prune -f
   ```

### Q6: å¦‚ä½•å‡çº§ç³»ç»Ÿï¼Ÿ

**A**: å‡çº§æ­¥éª¤ï¼š

1. å¤‡ä»½å½“å‰ç³»ç»Ÿï¼š
   ```bash
   ./backup.sh
   ```

2. æ‹‰å–æ–°ä»£ç ï¼š
   ```bash
   git pull origin main
   ```

3. é‡æ–°æ„å»ºé•œåƒï¼š
   ```bash
   docker-compose -f docker-compose.dev.yml build
   ```

4. æ‰§è¡Œæ•°æ®åº“å‡çº§è„šæœ¬ï¼ˆå¦‚æœæœ‰ï¼‰

5. é‡å¯æœåŠ¡ï¼š
   ```bash
   docker-compose -f docker-compose.dev.yml up -d
   ```

### Q7: å¦‚ä½•é‡ç½®ç³»ç»Ÿï¼Ÿ

**A**: å®Œå…¨é‡ç½®æ­¥éª¤ï¼š

1. åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰å®¹å™¨ï¼š
   ```bash
   docker-compose -f docker-compose.dev.yml down -v
   ```

2. åˆ é™¤ç›¸å…³é•œåƒï¼š
   ```bash
   docker rmi $(docker images | grep jsherp | awk '{print $3}')
   ```

3. é‡æ–°éƒ¨ç½²ï¼š
   ```bash
   ./deploy.sh
   ```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°æœ¬æ–‡æ¡£æœªæ¶µç›–çš„é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–æ”¯æŒï¼š

- **å®˜æ–¹ç½‘ç«™**: http://www.huaxiaerp.com/
- **GitHub Issues**: åœ¨é¡¹ç›® GitHub é¡µé¢æäº¤é—®é¢˜
- **ç¤¾åŒºè®ºå›**: å‚ä¸ç¤¾åŒºè®¨è®º
- **æŠ€æœ¯æ–‡æ¡£**: æŸ¥é˜…å®˜æ–¹æŠ€æœ¯æ–‡æ¡£

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025å¹´6æœˆ13æ—¥
**é€‚ç”¨ç‰ˆæœ¬**: jshERP æœ€æ–°ç‰ˆæœ¬
